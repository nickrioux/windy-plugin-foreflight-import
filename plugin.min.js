const t={name:"windy-plugin-foreflight-import",version:"1.0.0",icon:"✈️",title:"ForeFlight Import",description:"Import ForeFlight .fpl flight plans and visualize routes with weather",author:"Nicolas",desktopUI:"rhpane",mobileUI:"small",desktopWidth:280,routerPath:"/foreflight-import",built:1765833322327,builtReadable:"2025-12-15T21:15:22.327Z",screenshot:"screenshot.jpg"},e=W.broadcast,{map:n}=W.map;function o(){}function r(t){return t()}function i(){return Object.create(null)}function l(t){t.forEach(r)}function s(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(t,e){t.appendChild(e)}function u(t,e,n){const o=function(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;if(e&&e.host)return e;return t.ownerDocument}(t);if(!o.getElementById(e)){const t=d("style");t.id=e,t.textContent=n,function(t,e){c(t.head||t,e),e.sheet}(o,t)}}function h(t,e,n){t.insertBefore(e,n||null)}function p(t){t.parentNode&&t.parentNode.removeChild(t)}function d(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function v(){return f(" ")}function y(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function g(t){return function(e){return e.preventDefault(),t.call(this,e)}}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t,e){e=""+e,t.data!==e&&(t.data=e)}function w(t,e,n){t.classList.toggle(e,!!n)}let x;function $(t){x=t}function _(){if(!x)throw new Error("Function called outside component initialization");return x}const k=[],E=[];let N=[];const C=[],F=Promise.resolve();let P=!1;function M(t){N.push(t)}const I=new Set;let z=0;function A(){if(0!==z)return;const t=x;do{try{for(;z<k.length;){const t=k[z];z++,$(t),T(t.$$)}}catch(t){throw k.length=0,z=0,t}for($(null),k.length=0,z=0;E.length;)E.pop()();for(let t=0;t<N.length;t+=1){const e=N[t];I.has(e)||(I.add(e),e())}N.length=0}while(k.length);for(;C.length;)C.pop()();P=!1,I.clear(),$(t)}function T(t){if(null!==t.fragment){t.update(),l(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(M)}}const D=new Set;function O(t){return void 0!==t?.length?t:Array.from(t)}function B(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];N.forEach(o=>-1===t.indexOf(o)?e.push(o):n.push(o)),n.forEach(t=>t()),N=e}(n.after_update),l(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function R(t,e){-1===t.$$.dirty[0]&&(k.push(t),P||(P=!0,F.then(A)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function S(t,e,n,a,c,u,h=null,d=[-1]){const f=x;$(t);const v=t.$$={fragment:null,ctx:[],props:u,update:o,not_equal:c,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(f?f.$$.context:[])),callbacks:i(),dirty:d,skip_bound:!1,root:e.target||f.$$.root};h&&h(v.root);let y=!1;if(v.ctx=n?n(t,e.props||{},(e,n,...o)=>{const r=o.length?o[0]:n;return v.ctx&&c(v.ctx[e],v.ctx[e]=r)&&(!v.skip_bound&&v.bound[e]&&v.bound[e](r),y&&R(t,e)),n}):[],v.update(),y=!0,l(v.before_update),v.fragment=!!a&&a(v.ctx),e.target){if(e.hydrate){const t=function(t){return Array.from(t.childNodes)}(e.target);v.fragment&&v.fragment.l(t),t.forEach(p)}else v.fragment&&v.fragment.c();e.intro&&((g=t.$$.fragment)&&g.i&&(D.delete(g),g.i(m))),function(t,e,n){const{fragment:o,after_update:i}=t.$$;o&&o.m(e,n),M(()=>{const e=t.$$.on_mount.map(r).filter(s);t.$$.on_destroy?t.$$.on_destroy.push(...e):l(e),t.$$.on_mount=[]}),i.forEach(M)}(t,e.target,e.anchor),A()}var g,m;$(f)}class j{$$=void 0;$$set=void 0;$destroy(){B(this,1),this.$destroy=o}$on(t,e){if(!s(e))return o;const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");const q={title:"ForeFlight Import"};function U(t){const e=t.toUpperCase().trim();return"AIRPORT"===e?"airport":"VOR"===e||"NDB"===e||"NAVAID"===e?"navaid":"INT"===e||"FIX"===e||"INTERSECTION"===e?"fix":e.includes("USER")||e.includes("WAYPOINT")?"user":"unknown"}function V(t,e){const n=t.getElementsByTagName(e)[0];return n?.textContent?.trim()??""}function H(t,e,n,o){const r=(n-t)*Math.PI/180,i=(o-e)*Math.PI/180,l=Math.sin(r/2)*Math.sin(r/2)+Math.cos(t*Math.PI/180)*Math.cos(n*Math.PI/180)*Math.sin(i/2)*Math.sin(i/2);return 3440.065*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))}function X(t){let e=0;for(let n=1;n<t.length;n++){const o=t[n-1].waypoint,r=t[n].waypoint;e+=H(o.lat,o.lon,r.lat,r.lon)}return Math.round(e)}class Y{map;polyline=null;markers=[];routeColor;routeWeight;constructor(t){this.map=t.map,this.routeColor=t.routeColor??"#0066ff",this.routeWeight=t.routeWeight??3}render(t){this.clear();const e=t.routePoints.map(t=>L.latLng(t.waypoint.lat,t.waypoint.lon));this.polyline=L.polyline(e,{color:this.routeColor,weight:this.routeWeight,opacity:.8}).addTo(this.map),t.routePoints.forEach((e,n)=>{const o=this.createMarker(e,n,t.routePoints.length);this.markers.push(o),o.addTo(this.map)}),this.polyline&&this.map.fitBounds(this.polyline.getBounds(),{padding:[50,50]})}createMarker(t,e,n){const{waypoint:o}=t,r="airport"===o.type,i=0===e||e===n-1,l={radius:r?7:5,fillColor:r?"#00cc00":"#ffaa00",color:i?"#ff0000":"#ffffff",weight:i?3:2,fillOpacity:1},s=L.circleMarker([o.lat,o.lon],l);return s.bindTooltip(o.identifier,{permanent:!0,direction:"top",offset:[0,-8],className:"waypoint-label"}),s}clear(){this.polyline&&(this.polyline.remove(),this.polyline=null),this.markers.forEach(t=>t.remove()),this.markers=[]}}function Z(t){u(t,"svelte-hvh21y",".drop-zone.svelte-hvh21y.svelte-hvh21y{border:2px dashed rgba(255, 255, 255, 0.3);border-radius:8px;padding:24px 16px;text-align:center;cursor:pointer;transition:all 0.2s ease;margin-bottom:16px}.drop-zone.svelte-hvh21y.svelte-hvh21y:hover{border-color:rgba(255, 255, 255, 0.5);background:rgba(255, 255, 255, 0.05)}.drop-zone.drag-over.svelte-hvh21y.svelte-hvh21y{border-color:#0066ff;background:rgba(0, 102, 255, 0.1)}.drop-zone__text.svelte-hvh21y.svelte-hvh21y{color:rgba(255, 255, 255, 0.7);font-size:14px;line-height:1.5}.error-message.svelte-hvh21y.svelte-hvh21y{background:rgba(255, 0, 0, 0.2);border:1px solid rgba(255, 0, 0, 0.4);border-radius:4px;padding:8px 12px;margin-bottom:16px;color:#ff6b6b;font-size:13px}.route-info.svelte-hvh21y.svelte-hvh21y{margin-bottom:12px}.route-header.svelte-hvh21y.svelte-hvh21y{font-size:15px;margin-bottom:8px}.route-stats.svelte-hvh21y.svelte-hvh21y{display:flex;flex-direction:column;gap:4px;font-size:13px;color:rgba(255, 255, 255, 0.7)}.waypoint-list.svelte-hvh21y.svelte-hvh21y{max-height:300px;overflow-y:auto}.waypoint-item.svelte-hvh21y.svelte-hvh21y{display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px solid rgba(255, 255, 255, 0.1);font-size:13px}.waypoint-item.airport.svelte-hvh21y .waypoint-id.svelte-hvh21y{color:#00cc00}.waypoint-id.svelte-hvh21y.svelte-hvh21y{font-weight:600;min-width:60px}.waypoint-coords.svelte-hvh21y.svelte-hvh21y{color:rgba(255, 255, 255, 0.6);font-family:monospace;font-size:12px}.primary-btn.svelte-hvh21y.svelte-hvh21y{width:100%;padding:12px;background:#0066ff;border:none;border-radius:4px;color:white;cursor:pointer;font-size:14px;font-weight:600;transition:background 0.2s ease;margin-bottom:8px}.primary-btn.svelte-hvh21y.svelte-hvh21y:hover{background:#0052cc}.clear-btn.svelte-hvh21y.svelte-hvh21y{width:100%;padding:10px;background:rgba(255, 255, 255, 0.1);border:1px solid rgba(255, 255, 255, 0.2);border-radius:4px;color:white;cursor:pointer;font-size:14px;transition:background 0.2s ease}.clear-btn.svelte-hvh21y.svelte-hvh21y:hover{background:rgba(255, 255, 255, 0.2)}hr.svelte-hvh21y.svelte-hvh21y{border:none;border-top:1px solid rgba(255, 255, 255, 0.1);margin:12px 0}")}function G(t,e,n){const o=t.slice();return o[17]=e[n],o[19]=n,o}function J(t){let e;return{c(){e=d("span"),e.innerHTML="Drop .fpl file here<br/>or click to browse",m(e,"class","drop-zone__text svelte-hvh21y")},m(t,n){h(t,e,n)},d(t){t&&p(e)}}}function K(t){let e;return{c(){e=d("span"),e.textContent="Drop .fpl file here",m(e,"class","drop-zone__text svelte-hvh21y")},m(t,n){h(t,e,n)},d(t){t&&p(e)}}}function Q(t){let e,n;return{c(){e=d("div"),n=f(t[2]),m(e,"class","error-message svelte-hvh21y")},m(t,o){h(t,e,o),c(e,n)},p(t,e){4&e&&b(n,t[2])},d(t){t&&p(e)}}}function tt(t){let e,n,o,r,i,s,a,u,g,w,x,$,_,k,E,N,C,F,P,M,I,z,A,T,D,W,L,B,R,S,j=t[3].departure+"",q=t[3].destination+"",U=t[3].totalDistanceNm+"",V=t[3].routePoints.length+"",H=t[3].cruiseAltitudeFeet&&et(t),X=O(t[3].routePoints),Y=[];for(let e=0;e<X.length;e+=1)Y[e]=nt(G(t,X,e));return{c(){e=d("div"),n=d("div"),o=d("strong"),o.textContent="Route:",r=v(),i=f(j),s=f(" → "),a=f(q),u=v(),g=d("div"),w=d("span"),x=f("Distance: "),$=f(U),_=f(" nm"),k=v(),E=d("span"),N=f("Waypoints: "),C=f(V),F=v(),H&&H.c(),P=v(),M=d("hr"),I=v(),z=d("div");for(let t=0;t<Y.length;t+=1)Y[t].c();A=v(),T=d("hr"),D=v(),W=d("button"),W.textContent="Open in Distance & Planning",L=v(),B=d("button"),B.textContent="Clear Route",m(n,"class","route-header svelte-hvh21y"),m(g,"class","route-stats svelte-hvh21y"),m(e,"class","route-info svelte-hvh21y"),m(M,"class","svelte-hvh21y"),m(z,"class","waypoint-list svelte-hvh21y"),m(T,"class","svelte-hvh21y"),m(W,"class","primary-btn svelte-hvh21y"),m(B,"class","clear-btn svelte-hvh21y")},m(l,p){h(l,e,p),c(e,n),c(n,o),c(n,r),c(n,i),c(n,s),c(n,a),c(e,u),c(e,g),c(g,w),c(w,x),c(w,$),c(w,_),c(g,k),c(g,E),c(E,N),c(E,C),c(g,F),H&&H.m(g,null),h(l,P,p),h(l,M,p),h(l,I,p),h(l,z,p);for(let t=0;t<Y.length;t+=1)Y[t]&&Y[t].m(z,null);h(l,A,p),h(l,T,p),h(l,D,p),h(l,W,p),h(l,L,p),h(l,B,p),R||(S=[y(W,"click",t[8]),y(B,"click",t[7])],R=!0)},p(t,e){if(8&e&&j!==(j=t[3].departure+"")&&b(i,j),8&e&&q!==(q=t[3].destination+"")&&b(a,q),8&e&&U!==(U=t[3].totalDistanceNm+"")&&b($,U),8&e&&V!==(V=t[3].routePoints.length+"")&&b(C,V),t[3].cruiseAltitudeFeet?H?H.p(t,e):(H=et(t),H.c(),H.m(g,null)):H&&(H.d(1),H=null),8&e){let n;for(X=O(t[3].routePoints),n=0;n<X.length;n+=1){const o=G(t,X,n);Y[n]?Y[n].p(o,e):(Y[n]=nt(o),Y[n].c(),Y[n].m(z,null))}for(;n<Y.length;n+=1)Y[n].d(1);Y.length=X.length}},d(t){t&&(p(e),p(P),p(M),p(I),p(z),p(A),p(T),p(D),p(W),p(L),p(B)),H&&H.d(),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(Y,t),R=!1,l(S)}}}function et(t){let e,n,o,r,i=t[3].cruiseAltitudeFeet+"";return{c(){e=d("span"),n=f("Altitude: "),o=f(i),r=f(" ft")},m(t,i){h(t,e,i),c(e,n),c(e,o),c(e,r)},p(t,e){8&e&&i!==(i=t[3].cruiseAltitudeFeet+"")&&b(o,i)},d(t){t&&p(e)}}}function nt(t){let e,n,o,r,i,l,s,a,u,y=t[17].waypoint.identifier+"",g=rt(t[17].waypoint.lat,"lat")+"",x=rt(t[17].waypoint.lon,"lon")+"";return{c(){e=d("div"),n=d("span"),o=f(y),r=v(),i=d("span"),l=f(g),s=v(),a=f(x),u=v(),m(n,"class","waypoint-id svelte-hvh21y"),m(i,"class","waypoint-coords svelte-hvh21y"),m(e,"class","waypoint-item svelte-hvh21y"),w(e,"airport","airport"===t[17].waypoint.type)},m(t,p){h(t,e,p),c(e,n),c(n,o),c(e,r),c(e,i),c(i,l),c(i,s),c(i,a),c(e,u)},p(t,n){8&n&&y!==(y=t[17].waypoint.identifier+"")&&b(o,y),8&n&&g!==(g=rt(t[17].waypoint.lat,"lat")+"")&&b(l,g),8&n&&x!==(x=rt(t[17].waypoint.lon,"lon")+"")&&b(a,x),8&n&&w(e,"airport","airport"===t[17].waypoint.type)},d(t){t&&p(e)}}}function ot(t){let e,n,r,i,s,a,u,f,b,x,$,_;function k(t,e){return t[1]?K:J}let E=k(t),N=E(t),C=t[2]&&Q(t),F=t[3]&&tt(t);return{c(){var o,l;e=d("div"),e.textContent=`${t[4]}`,n=v(),r=d("section"),i=d("div"),i.textContent=`${t[4]}`,s=v(),a=d("div"),N.c(),u=v(),f=d("input"),b=v(),C&&C.c(),x=v(),F&&F.c(),m(e,"class","plugin__mobile-header"),m(i,"class","plugin__title plugin__title--chevron-back"),m(a,"class","drop-zone svelte-hvh21y"),w(a,"drag-over",t[1]),m(f,"type","file"),m(f,"accept",".fpl"),o="display",l="none",f.style.setProperty(o,l,""),m(r,"class","plugin__content")},m(o,l){h(o,e,l),h(o,n,l),h(o,r,l),c(r,i),c(r,s),c(r,a),N.m(a,null),c(r,u),c(r,f),t[14](f),c(r,b),C&&C.m(r,null),c(r,x),F&&F.m(r,null),$||(_=[y(i,"click",t[10]),y(a,"dragover",g(t[11])),y(a,"dragleave",t[12]),y(a,"drop",g(t[5])),y(a,"click",t[13]),y(f,"change",t[6])],$=!0)},p(t,[e]){E!==(E=k(t))&&(N.d(1),N=E(t),N&&(N.c(),N.m(a,null))),2&e&&w(a,"drag-over",t[1]),t[2]?C?C.p(t,e):(C=Q(t),C.c(),C.m(r,x)):C&&(C.d(1),C=null),t[3]?F?F.p(t,e):(F=tt(t),F.c(),F.m(r,null)):F&&(F.d(1),F=null)},i:o,o:o,d(o){o&&(p(e),p(n),p(r)),N.d(),t[14](null),C&&C.d(),F&&F.d(),$=!1,l(_)}}}function rt(t,e){const n=Math.abs(t).toFixed(2);return"lat"===e?`${n}°${t>=0?"N":"S"}`:`${n}°${t>=0?"E":"W"}`}function it(t,o,r){const{title:i}=q;let l,s=!1,a="",c=null,u=null;async function h(t){if(r(2,a=""),t.name.toLowerCase().endsWith(".fpl"))try{const e=await t.text();r(3,c=function(t){let e=t;65534!==t.charCodeAt(0)&&65279!==t.charCodeAt(0)||(e=t.substring(1)),e=e.replace(/\x00/g,"");const n=(new DOMParser).parseFromString(e,"application/xml"),o=n.querySelector("parsererror");if(o)throw new Error("Invalid FPL file: "+o.textContent);const r=new Map,i=n.getElementsByTagName("waypoint");for(const t of i){const e=V(t,"identifier");if(!e)continue;const n={identifier:e,type:U(V(t,"type")),lat:parseFloat(V(t,"lat"))||0,lon:parseFloat(V(t,"lon"))||0};r.set(e,n)}let l=null;const s=n.getElementsByTagName("flight-data")[0];if(s){const t=V(s,"altitude-ft");t&&(l=parseInt(t,10)||null)}const a=[],c=n.getElementsByTagName("route-point");for(const t of c){const e=V(t,"waypoint-identifier"),n=r.get(e);n?a.push({waypoint:n,altitudeFeet:l}):console.warn(`Waypoint not found in table: ${e}`)}if(0===a.length)throw new Error("No route points found in FPL file");const u=n.getElementsByTagName("route-name")[0];let h=u?.textContent?.trim()??"";const p=a[0].waypoint.identifier,d=a[a.length-1].waypoint.identifier;return h||(h=`${p} → ${d}`),{name:h,departure:p,destination:d,routePoints:a,totalDistanceNm:X(a),cruiseAltitudeFeet:l}}(e)),u||(u=new Y({map:n})),u.render(c)}catch(t){r(2,a=t instanceof Error?t.message:"Failed to parse file"),r(3,c=null)}else r(2,a="Please select a .fpl file")}var p;p=()=>{u=new Y({map:n})},_().$$.on_mount.push(p),function(t){_().$$.on_destroy.push(t)}(()=>{u?.clear()});return[l,s,a,c,i,function(t){r(1,s=!1);const e=t.dataTransfer?.files[0];e&&h(e)},function(t){const e=t.target,n=e.files?.[0];n&&h(n),e.value=""},function(){u?.clear(),r(3,c=null),r(2,a="")},function(){if(!c)return;const t=`https://www.windy.com/distance/${c.routePoints.map(t=>`${t.waypoint.lat.toFixed(4)},${t.waypoint.lon.toFixed(4)}`).join(";")}`;window.location.href=t},t=>{},()=>e.emit("rqstOpen","menu"),()=>r(1,s=!0),()=>r(1,s=!1),()=>l.click(),function(t){E[t?"unshift":"push"](()=>{l=t,r(0,l)})}]}class lt extends j{constructor(t){super(),S(this,t,it,ot,a,{onopen:9},Z)}get onopen(){return this.$$.ctx[9]}}export{t as __pluginConfig,lt as default};
